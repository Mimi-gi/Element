# Element ä»•æ§˜æ›¸

> æœ€çµ‚æ›´æ–°: 2026-02-10

## 1. ã‚²ãƒ¼ãƒ æ¦‚è¦

**Element**ã¯ã€æ§˜ã€…ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¹—ã‚Šç§»ã£ã¦é€²ã‚€**2Dãƒ‘ã‚ºãƒ«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒãƒ¼**ã§ã™ã€‚

### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ
- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æœ¬ä½“ã¯ã€Œ**ç›®ï¼ˆDarkï¼‰**ã€ã¨ã—ã¦è¡¨ç¾ã•ã‚Œã‚‹
- ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰ã§ä¹—ã‚Šç§»ã‚Šå¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç¢ºèªã—ã€æœ€é©ãªã‚‚ã®ã«ä¹—ã‚Šç§»ã‚‹
- å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å›ºæœ‰ã®èƒ½åŠ›ã‚’æŒã¡ï¼ˆç§»å‹•ã€ã‚¸ãƒ£ãƒ³ãƒ—ã€æµ®éŠãªã©ï¼‰ã€ãã‚Œã‚‰ã‚’é§†ä½¿ã—ã¦ãƒ‘ã‚ºãƒ«ã‚’è§£ã
- **ãƒ¡ãƒˆãƒ­ã‚¤ãƒ‰ãƒ´ã‚¡ãƒ‹ã‚¢**å½¢å¼ã®æ¢ç´¢å‹ãƒãƒƒãƒ—
- ãƒãƒªã‚ªã‚ªãƒ‡ãƒƒã‚»ã‚¤ã®ã€Œã‚­ãƒ£ãƒ—ãƒãƒ£ã€ã«è¿‘ã„ä¹—ã‚Šç§»ã‚Šãƒ¡ã‚«ãƒ‹ã‚¯ã‚¹

---

## 2. ã‚³ã‚¢ãƒ¡ã‚«ãƒ‹ã‚¯ã‚¹

### 2.1 ä¹—ã‚Šç§»ã‚Šã‚·ã‚¹ãƒ†ãƒ 

#### ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰
- **èµ·å‹•**: ãƒœã‚¿ãƒ³é•·æŠ¼ã—
- **åŠ¹æœ**: 
  - ã‚²ãƒ¼ãƒ æ™‚é–“ãŒæ¸›é€Ÿï¼ˆå€ç‡ã¯èª¿æ•´å¯èƒ½ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ0.3å€ï¼‰
  - ä¹—ã‚Šç§»ã‚Šå¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¦–è¦šçš„ã«ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤º
  - ç§»å‹•ãªã©ã®é€šå¸¸å…¥åŠ›ã¯ç„¡åŠ¹åŒ–
- **è§£é™¤**: ãƒœã‚¿ãƒ³ã‚’é›¢ã™

#### ä¹—ã‚Šç§»ã‚Šåˆ¤å®š

ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰ä¸­ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯3æ®µéšã§è¡¨ç¤ºã•ã‚Œã‚‹ï¼š

1. **ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å¤–** - ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ï¼ˆä¹—ã‚Šç§»ã‚Šä¸å¯ï¼‰
2. **å€™è£œ** - ä¹—ã‚Šç§»ã‚Šå¯èƒ½ã ãŒæœ€é©ã§ã¯ãªã„ï¼ˆã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã§æç¤ºï¼‰
3. **æœ€é©ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ** - ç¾åœ¨ä¹—ã‚Šç§»ã‚Šå¯èƒ½ï¼ˆå¼·èª¿è¡¨ç¤º/ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼‰

**æœ€é©ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®é¸å®šæ¡ä»¶**ï¼š
- ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®**ã‚³ã‚¢**ãŒã‚«ãƒ¡ãƒ©ã‹ã‚‰è¦‹ãˆã¦ã„ã‚‹
- **AND** ç¾åœ¨Possessä¸­ã®ã‚³ã‚¢ã«æœ€ã‚‚è¿‘ã„

#### ä¹—ã‚Šç§»ã‚Šå®Ÿè¡Œ
- ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰ä¸­ã«ä¹—ã‚Šç§»ã‚Šå…¥åŠ›
- æœ€é©ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ä¹—ã‚Šç§»ã‚‹
- å¤ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®çŠ¶æ…‹ã‚’è§£é™¤ã€æ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«Possess

### 2.2 Darkï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æœ¬ä½“ï¼‰

- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æœ¬ä½“ã§ã‚ã‚‹ã€Œç›®ã€
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®IPossable
- ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¹—ã‚Šç§»ã‚‹ã¨ã€å¤ã„Darkã¯è‡ªå‹•ã§ç ´æ£„ã•ã‚Œã‚‹
- Darkã‚‚æ­»äº¡ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

#### ãƒªã‚¹ãƒãƒ¼ãƒ³
- ä»»æ„ã®IPossableãŒæ­»äº¡ã™ã‚‹ã¨ã€**DarkSource**ã®ä½ç½®ã«æ–°ã—ã„DarkãŒç”Ÿæˆã•ã‚Œã‚‹
- DarkSourceã¯ã‚¹ãƒ†ãƒ¼ã‚¸ã”ã¨ã«é…ç½®å¯èƒ½ï¼ˆè¤‡æ•°å­˜åœ¨å¯èƒ½ï¼‰
- StageManagerãŒç¾åœ¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªDarkSourceã‚’ç®¡ç†

---

## 3. æŠ€è¡“è¨­è¨ˆ

### 3.1 ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ

#### IPossableï¼ˆåŸºæœ¬ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰

ã™ã¹ã¦ã®ä¹—ã‚Šç§»ã‚Šå¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå®Ÿè£…ã€‚

```csharp
public interface IPossable
{
    void TryPossess();           // ä¹—ã‚Šç§»ã‚Šå…¥åŠ›é€šçŸ¥
    int Layer { get; }           // ç‹¬è‡ªãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®é †åºå€¤
    bool IsPossess { get; set; } // ç¾åœ¨ä¹—ã‚Šç§»ã‚‰ã‚Œã¦ã„ã‚‹ã‹
    Transform Core { get; }      // ã‚³ã‚¢ï¼ˆè¦–èªæ€§ãƒ»è·é›¢åˆ¤å®šç”¨ï¼‰
    void Death();                // æ­»äº¡å‡¦ç†
}
```

**è¨­è¨ˆã®ãƒã‚¤ãƒ³ãƒˆ**ï¼š
- `Core`ã¯å­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦å®Ÿè£…
- `Layer`ã¯æç”»é †åºã‚’æ˜ç¤ºçš„ã«æŒ‡å®šï¼ˆSortingLayerã¨ã¯ç‹¬ç«‹ï¼‰
- `IsPossess`ãŒtrueã®é–“ã®ã¿ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã‚‹

#### èƒ½åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

IPossableã®èƒ½åŠ›ã‚’çµ„ã¿åˆã‚ã›å¯èƒ½ã«ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç¾¤ã€‚

**IHorizontalMovable** - æ¨ªç§»å‹•
```csharp
public interface IHorizontalMovable
{
    void MoveHorizontal(float direction); // -1:å·¦, 1:å³, 0:åœæ­¢
}
```

**IVerticalMovable** - ç¸¦ç§»å‹•
```csharp
public interface IVerticalMovable
{
    void MoveVertical(float direction); // -1:ä¸‹, 1:ä¸Š, 0:åœæ­¢
}
```

**IJumpable** - ã‚¸ãƒ£ãƒ³ãƒ—
```csharp
public interface IJumpable
{
    void Jump();
}
```

**å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**ï¼š
```csharp
public class Box : MonoBehaviour, IPossable, IHorizontalMovable, IJumpable
{
    void Start()
    {
        // IsPossessä¸­ã®ã¿å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã‚‹
        InputProcessor.Instance.Move
            .Where(_ => IsPossess)
            .Subscribe(dir => MoveHorizontal(dir.x))
            .AddTo(this);
    }
}
```

#### IDoublableï¼ˆåˆ†èº«ã‚·ã‚¹ãƒ†ãƒ ï¼‰

äºŒã¤ã«åˆ†ã‹ã‚Œã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”¨ã€‚IPossableã‚’ç¶™æ‰¿ã€‚

```csharp
public interface IDoublable : IPossable
{
    bool IsSplit { get; }
    void Split();
    void Merge();
    IPossable GetOtherHalf();
}
```

### 3.2 ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆVContainer + R3ï¼‰

**è¨­è¨ˆæ–¹é‡**ï¼š
- **VContainer**ã«ã‚ˆã‚‹ä¾å­˜æ€§æ³¨å…¥ã§æŸ”è»Ÿãªè¨­è¨ˆ
- **ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›®çš„åˆ¥ã«åˆ†é›¢**ã—ã€ç¥ã‚¯ãƒ©ã‚¹ã‚’å›é¿
- å„ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¯å¿…è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã ã‘ã«ä¾å­˜
- R3ï¼ˆReactiveProperty/Subjectï¼‰ã«ã‚ˆã‚‹ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•

#### ã‚¤ãƒ™ãƒ³ãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ

ã‚¤ãƒ™ãƒ³ãƒˆã‚’5ã¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«åˆ†é›¢ï¼š

**IGameStateEvents** - ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚¤ãƒ™ãƒ³ãƒˆ
```csharp
public interface IGameStateEvents
{
    ReactiveProperty<GameState> CurrentGameState { get; }
}
```
åˆ©ç”¨è€…: InputProcessor, TimeManager, PossessionManager

**IPossessionEvents** - ä¹—ã‚Šç§»ã‚Šã‚¤ãƒ™ãƒ³ãƒˆ
```csharp
public interface IPossessionEvents
{
    ReactiveProperty<IPossable> CurrentPossessed { get; }
    Subject<PossessionChangeEvent> OnPossessionChanged { get; }
    Subject<IPossable> OnPossessableDeath { get; }
}
```
åˆ©ç”¨è€…: PossessionManager, CameraController

**IFocusEvents** - ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆ
```csharp
public interface IFocusEvents
{
    Subject<bool> OnFocusModeChanged { get; }
}
```
åˆ©ç”¨è€…: TimeManager, PossessionManager, InputProcessor

**ICameraEvents** - ã‚«ãƒ¡ãƒ©é·ç§»ã‚¤ãƒ™ãƒ³ãƒˆ
```csharp
public interface ICameraEvents
{
    Subject<CameraTransitionEvent> OnCameraTransition { get; }
}
```
åˆ©ç”¨è€…: TimeManager, InputProcessor, CameraController

**IStageEvents** - ã‚¹ãƒ†ãƒ¼ã‚¸ç®¡ç†ã‚¤ãƒ™ãƒ³ãƒˆ
```csharp
public interface IStageEvents
{
    ReactiveProperty<DarkSource> ActiveDarkSource { get; }
    Subject<DarkSource> OnActiveAreaChanged { get; }
}
```
åˆ©ç”¨è€…: PossessionManager, StageManager

#### ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ä¸€è¦§

| ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ | è²¬å‹™ | ä¾å­˜ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ |
|------------|------|----------------|
| **GameStateManager** | ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç† | IGameStateEventsï¼ˆç™ºè¡Œï¼‰ |
| **PossessionManager** | ä¹—ã‚Šç§»ã‚Šã‚·ã‚¹ãƒ†ãƒ  | IPossessionEvents, IStageEvents, IGameStateEvents |
| **TimeManager** | Time.timeScaleåˆ¶å¾¡ | IFocusEvents, ICameraEvents |
| **StageManager** | DarkSourceç®¡ç† | IStageEventsï¼ˆç™ºè¡Œï¼‰ |
| **InputProcessor** | å…¥åŠ›ç®¡ç†ã¨é…ä¿¡ | IGameStateEvents, IFocusEventsï¼ˆç™ºè¡Œï¼‰ |
| **CameraController** | ã‚«ãƒ¡ãƒ©åˆ¶å¾¡ | IPossessionEvents, ICameraEventsï¼ˆç™ºè¡Œï¼‰ |

#### VContainerè¨­å®š

**GameLifetimeScope**ã§ã‚¤ãƒ™ãƒ³ãƒˆã¨ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ç™»éŒ²ï¼š

```csharp
public class GameLifetimeScope : LifetimeScope
{
    protected override void Configure(IContainerBuilder builder)
    {
        // ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²ï¼ˆSingletonï¼‰
        builder.Register<IGameStateEvents, GameStateEvents>(Lifetime.Singleton);
        builder.Register<IPossessionEvents, PossessionEvents>(Lifetime.Singleton);
        builder.Register<IFocusEvents, FocusEvents>(Lifetime.Singleton);
        builder.Register<ICameraEvents, CameraEvents>(Lifetime.Singleton);
        builder.Register<IStageEvents, StageEvents>(Lifetime.Singleton);

        // ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ç™»éŒ²
        builder.RegisterComponentInHierarchy<GameStateManager>();
        builder.RegisterComponentInHierarchy<PossessionManager>();
        // ...
    }
}
```

#### ä¾å­˜é–¢ä¿‚å›³ï¼ˆMermaidï¼‰

```mermaid
classDiagram
    %% ã‚¤ãƒ™ãƒ³ãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
    class IGameStateEvents {
        <<interface>>
        +ReactiveProperty~GameState~ CurrentGameState
    }
    
    class IPossessionEvents {
        <<interface>>
        +ReactiveProperty~IPossable~ CurrentPossessed
        +Subject~PossessionChangeEvent~ OnPossessionChanged
        +Subject~IPossable~ OnPossessableDeath
    }
    
    class IFocusEvents {
        <<interface>>
        +Subject~bool~ OnFocusModeChanged
    }
    
    class ICameraEvents {
        <<interface>>
        +Subject~CameraTransitionEvent~ OnCameraTransition
    }
    
    class IStageEvents {
        <<interface>>
        +ReactiveProperty~DarkSource~ ActiveDarkSource
        +Subject~DarkSource~ OnActiveAreaChanged
    }

    %% ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
    class GameStateManager {
        +ChangeState(GameState)
    }
    
    class PossessionManager {
        +PossessTo(IPossable)
        +OnPossessableDeath(IPossable)
        -RespawnAsDark()
    }
    
    class TimeManager {
        +SetTimeScale(float)
        +EnterFocusMode()
        +ExitFocusMode()
    }
    
    class StageManager {
        +SetActiveDarkSource(DarkSource)
        +TransitionToArea(string)
    }
    
    class InputProcessor {
        +ReactiveProperty~Vector2~ Move
        +Subject~Unit~ PossessInput
        +Subject~Unit~ Jump
    }
    
    class CameraController {
        +MoveToArea(Transform, float, float)
        +FollowTarget(Transform)
    }

    %% VContaineræ³¨å…¥é–¢ä¿‚
    IGameStateEvents <.. GameStateManager : publishes
    IGameStateEvents <.. InputProcessor : subscribes
    IGameStateEvents <.. PossessionManager : subscribes
    
    IPossessionEvents <.. PossessionManager : publishes
    IPossessionEvents <.. CameraController : subscribes
    
    IFocusEvents <.. InputProcessor : publishes
    IFocusEvents <.. TimeManager : subscribes
    IFocusEvents <.. PossessionManager : subscribes
    
    ICameraEvents <.. CameraController : publishes
    ICameraEvents <.. TimeManager : subscribes
    
    IStageEvents <.. StageManager : publishes
    IStageEvents <.. PossessionManager : subscribes
```

#### ä¾å­˜é–¢ä¿‚ãƒãƒˆãƒªãƒƒã‚¯ã‚¹

| ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ | GameState | Possession | Focus | Camera | Stage |
|------------|-----------|------------|-------|--------|-------|
| **GameStateManager** | ğŸŸ¢ç™ºè¡Œ | - | - | - | - |
| **InputProcessor** | ğŸ”µè³¼èª­ | - | ğŸŸ¢ç™ºè¡Œ | - | - |
| **TimeManager** | - | - | ğŸ”µè³¼èª­ | ğŸ”µè³¼èª­ | - |
| **PossessionManager** | ğŸ”µè³¼èª­ | ğŸŸ¢ç™ºè¡Œ | ğŸ”µè³¼èª­ | - | ğŸ”µè³¼èª­ |
| **StageManager** | - | - | - | - | ğŸŸ¢ç™ºè¡Œ |
| **CameraController** | - | ğŸ”µè³¼èª­ | - | ğŸŸ¢ç™ºè¡Œ | - |

**è¨­è¨ˆã®ç‰¹å¾´**ï¼š
- âœ… **æ˜ç¤ºçš„ãªä¾å­˜**: ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ä¾å­˜ãŒä¸€ç›®ç­ç„¶
- âœ… **è²¬å‹™ã®åˆ†é›¢**: ã‚¤ãƒ™ãƒ³ãƒˆãŒç›®çš„åˆ¥ã«æ•´ç†
- âœ… **ç¥ã‚¯ãƒ©ã‚¹å›é¿**: å„ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¯å¿…è¦ãªæƒ…å ±ã®ã¿å‚ç…§
- âœ… **ãƒ†ã‚¹ãƒˆå®¹æ˜“**: ãƒ¢ãƒƒã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ç°¡å˜ã«ãƒ†ã‚¹ãƒˆå¯èƒ½
- âœ… **æ‹¡å¼µæ€§**: æ–°ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆã®è¿½åŠ ãŒæ—¢å­˜ã‚³ãƒ¼ãƒ‰ã«å½±éŸ¿ã—ãªã„



### 3.3 ã‚³ã‚¢è¦–èªæ€§åˆ¤å®š

ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ã‚¢ãŒä»–ã®ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã«è¦†ã‚ã‚Œã¦ã„ã‚‹ã‹ã‚’åˆ¤å®šã€‚

**æ¤œè¨ä¸­ã®å®Ÿè£…æ–¹æ³•**ï¼š
1. **Physics Raycast**ï¼ˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ¨å¥¨ï¼‰
   - ã‚«ãƒ¡ãƒ©ã‹ã‚‰ã‚³ã‚¢ã¸Raycastã‚’é£›ã°ã—ã¦é®è”½ç‰©ã‚’ãƒã‚§ãƒƒã‚¯
   - ã‚·ãƒ³ãƒ—ãƒ«ã§å®Ÿè£…ãŒå®¹æ˜“
   
2. **SortingLayer/OrderInLayer**
   - æç”»é †åºã‚’ä½¿ã£ãŸåˆ¤å®š
   - è¦–è¦šçš„ã«æ­£ç¢ºã ãŒè¤‡é›‘
   
3. **ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ **ï¼ˆæœ¬ç•ªæ¨å¥¨ï¼‰
   - IPossable.Layerã‚’æ´»ç”¨ã—ãŸç‹¬è‡ªåˆ¤å®š
   - åˆ¶å¾¡ã—ã‚„ã™ãã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚‚è‰¯å¥½

**å®Ÿè£…å„ªå…ˆåº¦**: ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã¯Raycast â†’ æ­£å¼ç‰ˆã¯ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ã‚¤ãƒ¤ãƒ¼

---

## 4. ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼

### ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ â†’ ä¹—ã‚Šç§»ã‚Š

```
1. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒœã‚¿ãƒ³é•·æŠ¼ã—
   â†“
2. GameStateManager: FocusModeã«é·ç§»
   â†“
3. TimeManager: æ™‚é–“ã‚’æ¸›é€Ÿï¼ˆ0.3å€ï¼‰
   â†“
4. PossessionManager: æœ€é©ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’é¸å®šãƒ»æ›´æ–°ï¼ˆæ¯ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰
   â†“
5. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒä¹—ã‚Šç§»ã‚Šå…¥åŠ›
   â†“
6. PossessionManager: PossessTo(æœ€é©ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ)
   - å¤ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®IsPossess = false
   - Darkãªã‚‰ç ´æ£„
   - æ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®IsPossess = true
   â†“
7. GameEvents: OnPossessionChangedã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
   â†“
8. ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰çµ‚äº† â†’ æ™‚é–“ã‚’é€šå¸¸ã«æˆ»ã™
```

### æ­»äº¡ â†’ ãƒªã‚¹ãƒãƒ¼ãƒ³

```
1. IPossable.Death()ãŒå‘¼ã°ã‚Œã‚‹
   â†“
2. PossessionManager.OnPossessableDeath()
   â†“
3. StageManager.CurrentDarkSourceã‚’å–å¾—
   â†“
4. DarkSourceã®ä½ç½®ã«æ–°ã—ã„Darkã‚’ç”Ÿæˆ
   â†“
5. PossessionManager.PossessTo(æ–°Dark)
```

---

## 5. ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå®Ÿè£…ä¾‹

| ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ | èƒ½åŠ› | èª¬æ˜ |
|------------|------|------|
| **Darkï¼ˆé—‡ï¼‰** | `IHorizontalMovable` | ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æœ¬ä½“ã€‚æ¨ªç§»å‹•ã®ã¿ã€‚ã™ã¹ã¦ã®èµ·ç‚¹ |
| **Springï¼ˆã°ã­ï¼‰** | `IHorizontalMovable, IJumpable` | æ¨ªç§»å‹•ã¨ã‚¸ãƒ£ãƒ³ãƒ—ãŒå¯èƒ½ |
| **Boxï¼ˆç®±ï¼‰** | `IHorizontalMovable` | æ¨ªç§»å‹•ã®ã¿ã€‚è¸ã‚ã‚‹ï¼ˆæ¥åœ°å¯èƒ½ï¼‰ |
| **Elevatorï¼ˆã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ï¼‰** | `IVerticalMovable` | ç¸¦ç§»å‹•ã®ã¿ â€»å°†æ¥çš„ã«ãƒ‘ã‚¹ç§»å‹•ã‚‚æ¤œè¨ |
| **Balloonï¼ˆæ°—çƒï¼‰** | `IHorizontalMovable, IVerticalMovable` | æ¨ªç§»å‹•ã¨ç¸¦ç§»å‹•ãŒå¯èƒ½ |
| **Rockï¼ˆå²©ï¼‰** | `IPossable`ã®ã¿ | ç§»å‹•ä¸å¯ã€‚é‡ã—ã¨ã—ã¦ä½¿ç”¨ |

---

## 6. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **Unity 6000.3+** (URP)
- **C# 6000.0+**
- **VContainer** - ä¾å­˜æ€§æ³¨å…¥ï¼ˆDIï¼‰ã‚³ãƒ³ãƒ†ãƒŠ
- **R3** - ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ï¼‰
- **LitMotion** - ã‚«ãƒ¡ãƒ©ç§»å‹•ã®ãƒˆã‚¥ã‚¤ãƒ¼ãƒ³
- **Input System** - å…¥åŠ›ç®¡ç†
- **UniTask** - éåŒæœŸå‡¦ç†

- **VContainer** - ä¾å­˜æ€§æ³¨å…¥
---

## 7. ä»Šå¾Œã®æ‹¡å¼µå¯èƒ½æ€§

### èƒ½åŠ›ã®è¿½åŠ 
- `IDashable` - ãƒ€ãƒƒã‚·ãƒ¥èƒ½åŠ›
- `ISwimmable` - æ°´ä¸­ç§»å‹•
- `IGlidable` - æ»‘ç©º
- `IPushable` - ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŠ¼ã™ã€‚å‹•ã‹ã™

### IDoublableæ´»ç”¨
- äºŒã¤ã«åˆ†ã‹ã‚Œã¦åŒæ™‚ã«æ“ä½œ
- ãƒ‘ã‚ºãƒ«è¦ç´ ã¨ã—ã¦ä¸¡æ–¹ã®ã‚³ã‚¢ã‚’ç‰¹å®šã®ä½ç½®ã«é…ç½®

### ã‚¹ãƒ†ãƒ¼ã‚¸ã‚®ãƒŸãƒƒã‚¯
- ãƒœã‚¿ãƒ³/ã‚¹ã‚¤ãƒƒãƒï¼ˆIPressableï¼‰
- å‹•ãåºŠï¼ˆIMovingPlatformï¼‰
- ãƒ¯ãƒ¼ãƒ—ã‚¾ãƒ¼ãƒ³
- æ™‚é–“åˆ¶é™ã‚¨ãƒªã‚¢


#### è¨­è¨ˆã«ã¤ã„ã¦
- GameEventsãŒç¥ã‚¯ãƒ©ã‚¹ã«ãªã£ã¦ã„ã‚‹ã€‚
æ˜ã‚‰ã‹ã«é–¢ä¿‚ã®ãªã„ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚‚GameEventsã‚’ä»‹ã—ã¦é€šä¿¡ã—ã¦ã—ã¾ã£ã¦ã„ã‚‹ã€‚ã®ã§ã€å¿…è¦ãªæƒ…å ±ã ã‘ã‚’å–æ¨ã™ã‚‹ã‚ˆã†ã«ã§ãã¦ã„ãªã„ã€‚ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ¢ãƒ¼ãƒ‰å‘¨ã‚Šã®ã‚¤ãƒ™ãƒ³ãƒˆã‚„ã€ã‚¹ãƒ†ãƒ¼ã‚¸ç§»å‹•ã ã‘ã®ã‚¤ãƒ™ãƒ³ãƒˆã®ã‹ã‚‰å¿…è¦ãªã‚‚ã®ã‚’é©å®œæŠœãå–ã‚‹ã¨ã„ã†å½¢ã«ã—ãŸã„ã€ä»Šã®ã‚¦ãƒ‹ã®ã‚ˆã†ãªè¨­è¨ˆã§ã¯ãªãã€ã‚ˆã‚ŠæŸ”è»Ÿãªè¨­è¨ˆã«ã—ãŸã„ã€‚ã¾ãŸã€VContainerã‚’ä½¿ã£ã¦ä¾å­˜æ€§ã‚’ã‚ˆã‚ŠæŸ”è»Ÿã«ã§ããªã„ã‹ï¼Ÿ